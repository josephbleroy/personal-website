<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=author content="map[name:Joseph]"><meta name=description content="There&amp;rsquo;s been a lot of focus on internet security and encryption over the past several years. You&amp;rsquo;ll find dozens of news reports every day about companies getting breached, individuals having their bank accounts compromised, and security researchers finding vulnerabilities in web services and encryption protocols.
As someone who is passionate about security and technology, I&amp;rsquo;ve been driven to keep up with current standards and implement best practices so that I don&amp;rsquo;t become victim to preventable vulnerabilities."><meta name=keywords content><meta name=robots content="noodp"><meta name=theme-color content><link rel=canonical href=https://josephbleroy.com/posts/2017/01/implementing-https-and-http-headers-in-nginx/><title>Implementing HTTPS and HTTP Headers in Nginx :: Joseph B. LeRoy — Hello Friend NG Theme</title><link href=https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css rel=stylesheet type=text/css><link rel=stylesheet href=https://josephbleroy.com/main.d7bdd8ee18bfbf4c605488a7e5b1b92cd980dfeed2bdaeab4dd5e931a7a78bc0.css><link rel=apple-touch-icon sizes=180x180 href=https://josephbleroy.com/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://josephbleroy.com/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://josephbleroy.com/favicon-16x16.png><link rel=manifest href=https://josephbleroy.com/site.webmanifest><link rel=mask-icon href=https://josephbleroy.com/safari-pinned-tab.svg color=#1b1c1d><link rel="shortcut icon" href=https://josephbleroy.com/favicon.ico><meta name=msapplication-TileColor content="#1b1c1d"><meta name=theme-color content="#1b1c1d"><meta itemprop=name content="Implementing HTTPS and HTTP Headers in Nginx"><meta itemprop=description content="There&rsquo;s been a lot of focus on internet security and encryption over the past several years. You&rsquo;ll find dozens of news reports every day about companies getting breached, individuals having their bank accounts compromised, and security researchers finding vulnerabilities in web services and encryption protocols.
As someone who is passionate about security and technology, I&rsquo;ve been driven to keep up with current standards and implement best practices so that I don&rsquo;t become victim to preventable vulnerabilities."><meta itemprop=datePublished content="2017-01-08T00:00:00+00:00"><meta itemprop=dateModified content="2017-01-08T00:00:00+00:00"><meta itemprop=wordCount content="1482"><meta itemprop=image content="https://josephbleroy.com/"><meta itemprop=keywords content><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://josephbleroy.com/"><meta name=twitter:title content="Implementing HTTPS and HTTP Headers in Nginx"><meta name=twitter:description content="There&rsquo;s been a lot of focus on internet security and encryption over the past several years. You&rsquo;ll find dozens of news reports every day about companies getting breached, individuals having their bank accounts compromised, and security researchers finding vulnerabilities in web services and encryption protocols.
As someone who is passionate about security and technology, I&rsquo;ve been driven to keep up with current standards and implement best practices so that I don&rsquo;t become victim to preventable vulnerabilities."><meta property="og:title" content="Implementing HTTPS and HTTP Headers in Nginx"><meta property="og:description" content="There&rsquo;s been a lot of focus on internet security and encryption over the past several years. You&rsquo;ll find dozens of news reports every day about companies getting breached, individuals having their bank accounts compromised, and security researchers finding vulnerabilities in web services and encryption protocols.
As someone who is passionate about security and technology, I&rsquo;ve been driven to keep up with current standards and implement best practices so that I don&rsquo;t become victim to preventable vulnerabilities."><meta property="og:type" content="article"><meta property="og:url" content="https://josephbleroy.com/posts/2017/01/implementing-https-and-http-headers-in-nginx/"><meta property="og:image" content="https://josephbleroy.com/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2017-01-08T00:00:00+00:00"><meta property="article:modified_time" content="2017-01-08T00:00:00+00:00"><meta property="article:published_time" content="2017-01-08 00:00:00 +0000 UTC"></head><body><div class=container><header class=header><span class=header__inner><a href=https://josephbleroy.com/ style=text-decoration:none><div class=logo><span class=logo__mark>></span>
<span class=logo__text>$ cd /home/</span>
<span class=logo__cursor style=background-color:#50fa7b></span></div></a><span class=header__right><nav class=menu><ul class=menu__inner><li><a href=https://josephbleroy.com/posts/>Posts</a></li></ul></nav><span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg></span></span></span></header><div class=content><main class=post><div class=post-info><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>7 minutes</p></div><article><h1 class=post-title><a href=https://josephbleroy.com/posts/2017/01/implementing-https-and-http-headers-in-nginx/>Implementing HTTPS and HTTP Headers in Nginx</a></h1><div class=post-content><p>There&rsquo;s been a lot of focus on internet security and encryption over the past several years. You&rsquo;ll find dozens of news reports every day about companies getting breached, individuals having their bank accounts compromised, and security researchers finding vulnerabilities in web services and encryption protocols.</p><p>As someone who is passionate about security and technology, I&rsquo;ve been driven to keep up with current standards and implement best practices so that I don&rsquo;t become victim to preventable vulnerabilities. With that being said, I&rsquo;ve learned a few methods to make it more difficult for attackers to breach my servers and ways to prevent malicious content from being served from my websites, or to <a href=https://medium.com/google-developer-experts/the-importance-of-using-https-all-the-way-9c65c0224e86#.zhjctgif4>prevent attackers from using MitM attacks</a> (Man in the Middle) when users connect to rogue access points (malicious public wifi hotspots).</p><p>So why should we care about HTTPS and HTTP Headers? Well, most people want to ensure the information they send between their computer and the website they&rsquo;re connecting to remains confidential. That means that if someone were to &ldquo;sniff&rdquo; their network traffic, they wouldn&rsquo;t be able to understand what&rsquo;s in the payload (raw data being exchanged), which usually contains usernames, passwords, credit card info, and other PII (Personally Identifiable Information) content.</p><p>There are several ways to check your existing site to make sure you&rsquo;re using proper HTTP Headers and SSL/TLS configuration settings. A few which come to mind are <a href=https://www.ssllabs.com/ssltest/>Qualys SSL Labs - SSL Server Test</a> and <a href=https://securityheaders.io/>securityheaders.io</a>. I&rsquo;m also using a new service called <a href=https://www.hardenize.com>Hardenize</a>, which is a slightly more comprehensive test that checks for modern security settings.</p><h3 id=definitions>Definitions</h3><p>It&rsquo;s important to know what the following components are to better understand what is being worked on and why it&rsquo;s being modified.</p><ol><li><strong>Nginx:</strong> HTTP Web Server, Reverse Proxy, Load Balancer, etc. Nginx can also do other things, but it&rsquo;s mainly used as a conduit for serving content over ports 80 (HTTP) or 443 (HTTPS).</li></ol><ul><li><strong>SSL/TLS (HTTPS):</strong> Protocol used to encrypt traffic between two endpoints. It&rsquo;s what gives you the little green lock next to the URI in your browser. Additionally, it&rsquo;s signed by a CA to verify domain and server ownership.</li><li><strong>Content Security Policy:</strong> Computer security standard enforced by the server to prevent the browser from rendering malicious (unauthorized or dangerous) content. Prevent cross-site scripting (XSS), clickjacking, code injection, along with other vulnerabilities.</li></ul><h3 id=setting-up-https-and-http-headers-in-nginx>Setting up HTTPS and HTTP Headers in Nginx</h3><p>For this example, I&rsquo;ll be using Nginx and Ubuntu 16.04.1 LTS. First, we&rsquo;ll want to set up some variables (our domain name and directory) which will be used in the Let&rsquo;s Encrypt certificate generation procedure. Let&rsquo;s Encrypt will insert a small file in a hidden directory at <code>/var/www/josephbleroy.com/html</code> to verify domain and server ownership.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>export DOMAINS<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;josephbleroy.com,www.josephbleroy.com&#34;</span>
export DIR<span style=color:#f92672>=</span>/var/www/josephbleroy.com/html
sudo letsencrypt certonly -a webroot --webroot-path<span style=color:#f92672>=</span>$DIR -d $DOMAINS
</code></pre></div><p>You should now be able to use your new certificate / keys to encrypt traffic between the web browser and web server. We&rsquo;ll also want to redirect all HTTP traffic to HTTPS (301 Redirect), implement the certificate and keys we generated to establish the encrypted (TLS 1.2 over port 443) connection, and add HTTP Headers (Content-Security-Policy, X-XSS-Protection, X-Frame-Options). All certificates and keys will be stored in <code>/etc/letsencrypt/live/</code>, for Ubuntu 16.04.1 LTS.</p><p>Let&rsquo;s get started by using vim or another editor to create or edit the following file:</p><p><code>sudo vim /etc/nginx/sites-available/josephbleroy.com</code></p><p>Implement the following code in your file and replace my domain name with your domain name. You can quickly do that in vim by using <code>:%s/jospehbleroy.com/yourdomainname.com/g</code>.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nginx data-lang=nginx><span style=color:#66d9ef>server</span> {
     <span style=color:#f92672>listen</span> <span style=color:#ae81ff>80</span>;
     <span style=color:#f92672>listen</span> <span style=color:#ae81ff>443</span> <span style=color:#e6db74>ssl</span> <span style=color:#e6db74>http2</span>;
     <span style=color:#f92672>server_name</span> <span style=color:#e6db74>josephbleroy.com</span> <span style=color:#e6db74>www.josephbleroy.com</span>;
     <span style=color:#f92672>ssl_protocols</span> <span style=color:#e6db74>TLSv1.2</span>;
     <span style=color:#f92672>ssl_ciphers</span> <span style=color:#e6db74>EECDH+AES128:RSA+AES128:EECDH+AES256:RSA+AES256:EECDH+3DES:RSA+3DES:!MD5</span>;
     <span style=color:#f92672>ssl_prefer_server_ciphers</span> <span style=color:#e6db74>On</span>;
     <span style=color:#f92672>ssl_certificate</span> <span style=color:#e6db74>/etc/letsencrypt/live/josephbleroy.com/fullchain.pem</span>;
     <span style=color:#f92672>ssl_certificate_key</span> <span style=color:#e6db74>/etc/letsencrypt/live/josephbleroy.com/privkey.pem</span>;
     <span style=color:#f92672>ssl_trusted_certificate</span> <span style=color:#e6db74>/etc/letsencrypt/live/josephbleroy.com/chain.pem</span>;
     <span style=color:#f92672>ssl_session_cache</span> <span style=color:#e6db74>shared:SSL:128m</span>;
     <span style=color:#f92672>add_header</span> <span style=color:#e6db74>Strict-Transport-Security</span> <span style=color:#e6db74>&#34;max-age=31557600</span>; <span style=color:#f92672>includeSubDomains&#34;</span>;
     <span style=color:#f92672>add_header</span> <span style=color:#e6db74>X-Frame-Options</span> <span style=color:#e6db74>&#34;SAMEORIGIN&#34;</span> <span style=color:#e6db74>always</span>;
     <span style=color:#f92672>add_header</span> <span style=color:#e6db74>X-Content-Type-Options</span> <span style=color:#e6db74>&#34;nosniff&#34;</span> <span style=color:#e6db74>always</span>;
     <span style=color:#f92672>add_header</span> <span style=color:#e6db74>X-Xss-Protection</span> <span style=color:#e6db74>&#34;1</span>; <span style=color:#f92672>mode=block&#34;</span> <span style=color:#e6db74>always</span>;
     <span style=color:#f92672>add_header</span> <span style=color:#e6db74>Content-Security-Policy</span> <span style=color:#e6db74>&#34;script-src</span> <span style=color:#e6db74>&#39;self&#39;</span> <span style=color:#e6db74>&#39;unsafe-inline&#39;</span> <span style=color:#e6db74>&#39;unsafe-eval&#39;</span> <span style=color:#e6db74>*.youtube.com</span> <span style=color:#e6db74>maps.gstatic.com</span> <span style=color:#e6db74>*.googleapis.com</span> <span style=color:#e6db74>*.google-analytics.com</span> <span style=color:#e6db74>assets.zendesk.com</span> <span style=color:#e6db74>connect.facebook.net</span>; <span style=color:#f92672>frame-src</span> <span style=color:#e6db74>&#39;self&#39;</span> <span style=color:#e6db74>*.youtube.com</span> <span style=color:#e6db74>assets.zendesk.com</span> <span style=color:#e6db74>*.facebook.com</span> <span style=color:#e6db74>s-static.ak.facebook.com</span> <span style=color:#e6db74>tautt.zendesk.com</span>; <span style=color:#f92672>object-src</span> <span style=color:#e6db74>&#39;self&#39;&#34;</span>;
     <span style=color:#f92672>ssl_stapling</span> <span style=color:#66d9ef>on</span>;
     <span style=color:#f92672>ssl_stapling_verify</span> <span style=color:#66d9ef>on</span>;
     <span style=color:#75715e># Your favorite resolver may be used instead of the Google one below
</span><span style=color:#75715e></span>     <span style=color:#f92672>resolver</span> <span style=color:#ae81ff>8</span><span style=color:#e6db74>.8.8.8</span>;
     <span style=color:#f92672>root</span> <span style=color:#e6db74>/var/www/josephbleroy.com/html</span>;
     <span style=color:#f92672>index</span> <span style=color:#e6db74>index.html</span>;

     <span style=color:#f92672>location</span> <span style=color:#e6db74>&#39;/.well-known/acme-challenge&#39;</span> {
        <span style=color:#f92672>root</span>        <span style=color:#e6db74>/var/www/josephbleroy.com/html</span>;
      }

     <span style=color:#f92672>location</span> <span style=color:#e6db74>/</span> {
              <span style=color:#f92672>if</span> <span style=color:#e6db74>(</span>$scheme = <span style=color:#e6db74>http)</span> {
                <span style=color:#f92672>return</span> <span style=color:#ae81ff>301</span> <span style=color:#e6db74>https://</span>$server_name$request_uri;
              }
     }
}
</code></pre></div><p>You can add additional directives and values to <strong>Content-Security-Policy</strong> to match the resource providers you use on your website. For example, if you have a JavaScript file on Cloud Flare&rsquo;s CDN JavaScript server(s), you&rsquo;ll need to add a value for <code>cdnjs.cloudflare.com</code> so that it looks like this:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nginx data-lang=nginx><span style=color:#66d9ef>add_header</span> <span style=color:#e6db74>Content-Security-Policy</span> <span style=color:#e6db74>&#34;script-src</span> <span style=color:#e6db74>&#39;self&#39;</span> <span style=color:#e6db74>&#39;unsafe-inline&#39;</span> <span style=color:#e6db74>&#39;unsafe-eval&#39;</span> <span style=color:#e6db74>cdnjs.cloudflare.com</span>;
</code></pre></div><p>Now we need to make sure our Nginx configuration file is properly formatted. We&rsquo;ll also need to reload our server to ensure the changes we made go into effect. We can do run a check using <code>sudo nginx -t && sudo nginx -s reload</code>. If there&rsquo;s any issue with our configuration, Nginx won&rsquo;t be reloaded and we&rsquo;ll have an output on where our syntax is incorrect.</p><p>We also want to make sure our certificates never expire, so we&rsquo;ll setup a small script and cron job to check the validity of our certificate and renew if possible:</p><p>First, we need to create the script. We can do that by <code>sudo vim renewCerts.sh</code> and then we&rsquo;ll need to insert the following script into the file:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#75715e>#!/bin/sh
</span><span style=color:#75715e></span><span style=color:#75715e># This script renews all the Let&#39;s Encrypt certificates with a validity &lt; 30 days</span>

<span style=color:#66d9ef>if</span> ! letsencrypt renew &gt; /var/log/letsencrypt/renew.log 2&gt;&amp;<span style=color:#ae81ff>1</span> ; <span style=color:#66d9ef>then</span>
    echo Automated renewal failed:
    cat /var/log/letsencrypt/renew.log
    exit <span style=color:#ae81ff>1</span>
<span style=color:#66d9ef>fi</span>
/usr/sbin/nginx -t <span style=color:#f92672>&amp;&amp;</span> /usr/sbin/nginx -s reload
</code></pre></div><p>Make sure you <code>:wq</code> to save the file and then we&rsquo;ll need to setup the cron job using <code>sudo crontab -e</code>, then we&rsquo;ll set the time we want to run the script <code>@daily /etc/letsencrypt/renewCerts.sh</code>, and finally we&rsquo;ll make it executable <code>chmod +x /etc/letsencrypt/renewCerts.sh</code>.</p><p>We&rsquo;re now finished our first site&rsquo;s certificate. Our script will run daily and check if the certificate is going to expire in less than 30 days. If it&rsquo;s less than 30 days until expiry, it&rsquo;ll be renewed for another 90 days.</p><p><img src=https://storage.googleapis.com/josephbleroy-images/images/2017/image2.png alt></p><p>If there&rsquo;s any type of error, it&rsquo;s probably related to the script not being able to be executed. You&rsquo;ll have to play around with the permissions. You can run the commands in the script individually using the <code>--dry-run</code>, which will simulate the command without actually executing it.</p><h3 id=adding-additional-certificates-and-sites>Adding Additional Certificates and Sites</h3><p>I currently host several personal websites on one VPS (Virtual Private Server) using Google Cloud Platform. I have one instance of Nginx running and I have several virtual host configurations for each site. I won&rsquo;t go into too much detail because that&rsquo;s a topic within itself, but if you want to serve multiple sites on one IP address (server) you can simply follow the above steps once each host configuration is created and linked.</p><p>You can create a new virtual host file by doing the following:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>sudo mkdir /var/www/yourfirstsite.you/html
sudo mkdir /var/www/yoursecondsite.you/html
sudo vim /etc/nginx/sites-available/yourfirstsite.you
sudo vim /etc/nginx/sites-available/yoursecondsite.you
sudo ln -s /etc/nginx/sites-available/yourfirstsite.you /etc/nginx/sites-enabled/
sudo ln -s /etc/nginx/sites-available/yoursecondsite.you /etc/nginx/sites-enabled
</code></pre></div><p>You&rsquo;ll now be able to serve multiple sites after you replace all the domain and directory values, as well as the value for each certificate, in <code>/etc/nginx/sites-available/yourfirstsite.you</code> and <code>/etc/nginx/sites-available/yoursecondsite.you</code>. After that, make sure you check the syntax and reload Nginx using <code>sudo nginx -t && sudo nginx -s reload</code>.</p><h3 id=future-work>Future Work</h3><p>There&rsquo;s a few things I want to implement in the near future. I&rsquo;d like to build Nginx from source so that I can implement an new AEAD (Authenticated Encryption with Associated Data) cipher suite called <strong>ChaCha20-Poly1305</strong>. It&rsquo;ll be the standard and only option once <a href=https://tools.ietf.org/html/rfc7539>(TLSv1.3)</a> is released. Most mobile devices do not support AES Hardware Acceleration, so this cipher suite will improve performance by roughly ~200%, which is pretty great.</p><p>To do this we&rsquo;ll have to build Nginx with a custom version of OpenSSL. As always, make sure you backup your site before performing any of the following commands:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>cd ~
mkdir nginx
cd nginx
wget http://nginx.org/download/nginx-1.11.8.tar.gz
tar -xzvf nginx-1.11.8.tar.gz
rm nginx-1.11.8.tar.gz
</code></pre></div><p>This will download the mainline (development) version of Nginx. We&rsquo;ll also need to do the same with OpenSSL, so make sure you remain in the same directory:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>wget https://www.openssl.org/source/openssl-1.1.0c.tar.gz
tar -xzvf openssl-1.1.0c.tar.gz
rm openssl-1.1.0c.tar.gz
</code></pre></div><p>Now we&rsquo;re going to configure Nginx 1.11.8 to work with OpenSSL 1.1.0c, which supports ChaCha20-Poly1305:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>cd nginx-1.11.8
./configure <span style=color:#f92672>(</span>existing configure arguments<span style=color:#f92672>)</span> --with-openssl<span style=color:#f92672>=</span>/home/joe/nginx/openssl-1.1.0c
</code></pre></div><p>Now we need to build Nginx so that it includes OpenSSL 1.1.0c (you might need to run them using sudo):</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>make
sudo make install
sudo service nginx restart
</code></pre></div><p>You can read more about this cipher suite on Scott Helme&rsquo;s (a very talented security researcher from the United Kingdom) <a href=https://scotthelme.co.uk/doing-the-chacha-with-nginx/>website</a>.</p><h3 id=conclusion>Conclusion</h3><p>I hope this guide was somewhat helpful to help you get started with using Let&rsquo;s Encrypt. I intend to update this post with better terminology and more clear explanations. I&rsquo;ll probably add some more details about some of the individual settings as well, and update them if there are any vulnerabilities with the ciphers and encryptions methods used.</p><p>If there are any errors, please send me <a href=https://www.josephbleroy.com/page/contact>contact me</a> to let me know.</p></div></article><hr><div class=post-info><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6A2 2 0 004 4v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>1482 Words</p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>2017-01-08 00:00</p></div><hr><div class=sharing-buttons><a class=resp-sharing-button__link href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fjosephbleroy.com%2fposts%2f2017%2f01%2fimplementing-https-and-http-headers-in-nginx%2f" target=_blank rel=noopener aria-label title="Share on facebook"><div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 2h-3a5 5 0 00-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 011-1h3z"/></svg></div></div></a><a class=resp-sharing-button__link href="https://twitter.com/intent/tweet/?url=https%3a%2f%2fjosephbleroy.com%2fposts%2f2017%2f01%2fimplementing-https-and-http-headers-in-nginx%2f" target=_blank rel=noopener aria-label title="Share on twitter"><div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg></div></div></a><a class=resp-sharing-button__link href="https://www.tumblr.com/widgets/share/tool?posttype=link&title=Implementing%20HTTPS%20and%20HTTP%20Headers%20in%20Nginx&caption=Implementing%20HTTPS%20and%20HTTP%20Headers%20in%20Nginx&canonicalUrl=https%3a%2f%2fjosephbleroy.com%2fposts%2f2017%2f01%2fimplementing-https-and-http-headers-in-nginx%2f" target=_blank rel=noopener aria-label title="Share on tumblr"><div class="resp-sharing-button resp-sharing-button--tumblr resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentcolor" stroke="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.563 24c-5.093.0-7.031-3.756-7.031-6.411V9.747H5.116V6.648c3.63-1.313 4.512-4.596 4.71-6.469C9.84.051 9.941.0 9.999.0h3.517v6.114h4.801v3.633h-4.82v7.47c.016 1.001.375 2.371 2.207 2.371h.09c.631-.02 1.486-.205 1.936-.419l1.156 3.425c-.436.636-2.4 1.374-4.156 1.404h-.178l.011.002z"/></svg></div></div></a><a class=resp-sharing-button__link href="mailto:?subject=Implementing%20HTTPS%20and%20HTTP%20Headers%20in%20Nginx&body=https%3a%2f%2fjosephbleroy.com%2fposts%2f2017%2f01%2fimplementing-https-and-http-headers-in-nginx%2f" target=_self rel=noopener aria-label title="Share via email"><div class="resp-sharing-button resp-sharing-button--email resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1.0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1.0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg></div></div></a><a class=resp-sharing-button__link href="https://pinterest.com/pin/create/button/?url=https%3a%2f%2fjosephbleroy.com%2fposts%2f2017%2f01%2fimplementing-https-and-http-headers-in-nginx%2f&media=https%3a%2f%2fjosephbleroy.com%2fposts%2f2017%2f01%2fimplementing-https-and-http-headers-in-nginx%2f;description=Implementing%20HTTPS%20and%20HTTP%20Headers%20in%20Nginx" target=_blank rel=noopener aria-label title="Share on pinterest"><div class="resp-sharing-button resp-sharing-button--pinterest resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentcolor" stroke="none"><path d="M12.017.0C5.396.0.029 5.367.029 11.987c0 5.079 3.158 9.417 7.618 11.162-.105-.949-.199-2.403.041-3.439.219-.937 1.406-5.957 1.406-5.957s-.359-.72-.359-1.781c0-1.663.967-2.911 2.168-2.911 1.024.0 1.518.769 1.518 1.688.0 1.029-.653 2.567-.992 3.992-.285 1.193.6 2.165 1.775 2.165 2.128.0 3.768-2.245 3.768-5.487.0-2.861-2.063-4.869-5.008-4.869-3.41.0-5.409 2.562-5.409 5.199.0 1.033.394 2.143.889 2.741.099.12.112.225.085.345-.09.375-.293 1.199-.334 1.363-.053.225-.172.271-.401.165-1.495-.69-2.433-2.878-2.433-4.646.0-3.776 2.748-7.252 7.92-7.252 4.158.0 7.392 2.967 7.392 6.923.0 4.135-2.607 7.462-6.233 7.462-1.214.0-2.354-.629-2.758-1.379l-.749 2.848c-.269 1.045-1.004 2.352-1.498 3.146 1.123.345 2.306.535 3.55.535 6.607.0 11.985-5.365 11.985-11.987C23.97 5.39 18.592.026 11.985.026L12.017.0z"/></svg></div></div></a><a class=resp-sharing-button__link href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fjosephbleroy.com%2fposts%2f2017%2f01%2fimplementing-https-and-http-headers-in-nginx%2f&title=Implementing%20HTTPS%20and%20HTTP%20Headers%20in%20Nginx&summary=Implementing%20HTTPS%20and%20HTTP%20Headers%20in%20Nginx&source=https%3a%2f%2fjosephbleroy.com%2fposts%2f2017%2f01%2fimplementing-https-and-http-headers-in-nginx%2f" target=_blank rel=noopener aria-label title="Share on linkedin"><div class="resp-sharing-button resp-sharing-button--linkedin resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg></div></div></a><a class=resp-sharing-button__link href="https://reddit.com/submit/?url=https%3a%2f%2fjosephbleroy.com%2fposts%2f2017%2f01%2fimplementing-https-and-http-headers-in-nginx%2f&resubmit=true&title=Implementing%20HTTPS%20and%20HTTP%20Headers%20in%20Nginx" target=_blank rel=noopener aria-label title="Share on reddit"><div class="resp-sharing-button resp-sharing-button--reddit resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentcolor" stroke="none"><path d="M12 0A12 12 0 000 12a12 12 0 0012 12 12 12 0 0012-12A12 12 0 0012 0zm5.01 4.744c.688.0 1.25.561 1.25 1.249a1.25 1.25.0 01-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968.0 1.754.786 1.754 1.754.0.716-.435 1.333-1.01 1.614a3.111 3.111.0 01.042.52c0 2.694-3.13 4.87-7.004 4.87s-7.004-2.176-7.004-4.87c0-.183.015-.366.043-.534A1.748 1.748.0 014.028 12c0-.968.786-1.754 1.754-1.754.463.0.898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342.0 01.14-.197.35.35.0 01.238-.042l2.906.617a1.214 1.214.0 011.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687.0 1.248-.561 1.248-1.249S9.937 12 9.249 12zm5.5.0c-.687.0-1.248.561-1.248 1.25.0.687.561 1.248 1.249 1.248S16 13.937 16 13.249c0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327.0 00-.231.094.33.33.0 000 .463c.842.842 2.484.913 2.961.913s2.105-.056 2.961-.913a.361.361.0 00.029-.463.33.33.0 00-.464.0c-.547.533-1.684.73-2.512.73-.828.0-1.979-.196-2.512-.73a.326.326.0 00-.232-.095z"/></svg></div></div></a><a class=resp-sharing-button__link href="https://www.xing.com/app/user?op=share;url=https%3a%2f%2fjosephbleroy.com%2fposts%2f2017%2f01%2fimplementing-https-and-http-headers-in-nginx%2f;title=Implementing%20HTTPS%20and%20HTTP%20Headers%20in%20Nginx" target=_blank rel=noopener aria-label title="Share on xing"><div class="resp-sharing-button resp-sharing-button--xing resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentcolor" stroke="none"><path d="M18.188.0c-.517.0-.741.325-.927.66.0.0-7.455 13.224-7.702 13.657.015.024 4.919 9.023 4.919 9.023.17.308.436.66.967.66h3.454c.211.0.375-.078.463-.22.089-.151.089-.346-.009-.536l-4.879-8.916c-.004-.006-.004-.016.0-.022L22.139.756c.095-.191.097-.387.006-.535C22.056.078 21.894.0 21.686.0h-3.498zM3.648 4.74c-.211.0-.385.074-.473.216-.09.149-.078.339.02.531l2.34 4.05c.004.01.004.016.0.021L1.86 16.051c-.099.188-.093.381.0.529.085.142.239.234.45.234h3.461c.518.0.766-.348.945-.667l3.734-6.609-2.378-4.155c-.172-.315-.434-.659-.962-.659H3.648v.016z"/></svg></div></div></a><a class=resp-sharing-button__link href="whatsapp://send?text=Implementing%20HTTPS%20and%20HTTP%20Headers%20in%20Nginx%20https%3a%2f%2fjosephbleroy.com%2fposts%2f2017%2f01%2fimplementing-https-and-http-headers-in-nginx%2f" target=_blank rel=noopener aria-label title="Share on whatsapp"><div class="resp-sharing-button resp-sharing-button--whatsapp resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentcolor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198.0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479.0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87.0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86.0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64.0 5.122 1.03 6.988 2.898a9.825 9.825.0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815.0 0012.05.0C5.495.0.16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882.0 005.683 1.448h.005c6.554.0 11.89-5.335 11.893-11.893a11.821 11.821.0 00-3.48-8.413z"/></svg></div></div></a><a class=resp-sharing-button__link href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fjosephbleroy.com%2fposts%2f2017%2f01%2fimplementing-https-and-http-headers-in-nginx%2f&t=Implementing%20HTTPS%20and%20HTTP%20Headers%20in%20Nginx" target=_blank rel=noopener aria-label title="Share on hacker news"><div class="resp-sharing-button resp-sharing-button--hackernews resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentcolor" stroke="none"><path d="M0 24V0h24v24H0zM6.951 5.896l4.112 7.708v5.064h1.583v-4.972l4.148-7.799h-1.749l-2.457 4.875c-.372.745-.688 1.434-.688 1.434s-.297-.708-.651-1.434L8.831 5.896h-1.88z"/></svg></div></div></a><a class=resp-sharing-button__link href="https://telegram.me/share/url?text=Implementing%20HTTPS%20and%20HTTP%20Headers%20in%20Nginx&url=https%3a%2f%2fjosephbleroy.com%2fposts%2f2017%2f01%2fimplementing-https-and-http-headers-in-nginx%2f" target=_blank rel=noopener aria-label title="Share on telegram"><div class="resp-sharing-button resp-sharing-button--telegram resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></svg></div></div></a></div><div class=pagination><div class=pagination__title><span class=pagination__title-h></span><hr></div><div class=pagination__buttons><span class="button next"><a href=https://josephbleroy.com/posts/2016/09/the-current-state-of-devops-and-the-agile-movement-in-japan/><span class=button__text>The Current State of DevOps and the Agile Movement in Japan</span>
<span class=button__icon>→</span></a></span></div></div></main></div><footer class=footer><div class=footer__inner><div class=footer__content><span>&copy; 2021</span>
<span><a href=https://josephbleroy.com/>Joseph LeRoy</a></span>
<span><a href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank rel=noopener>CC BY-NC 4.0</a></span><span><a href=https://josephbleroy.com/posts/index.xml target=_blank title=rss><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a></span></div></div><div class=footer__inner><div class=footer__content><span>Powered by <a href=http://gohugo.io>Hugo</a></span>
<span>Theme by <a href=https://github.com/rhazdon>Djordje Atlialp</a></span></div></div></footer></div><script type=text/javascript src=https://josephbleroy.com/bundle.min.2ce64ea6ea44a72b13dd812fc2eb5cca3efe878cce258a47c137c17edf46e0602a05e422b618a5b80b5939c731b7a293351c2f2222a21f6ee27e54a8448dd20e.js integrity="sha512-LOZOpupEpysT3YEvwutcyj7+h4zOJYpHwTfBft9G4GAqBeQithiluAtZOccxt6KTNRwvIiKiH27iflSoRI3SDg=="></script></body></html>